pipeline {
    agent any

     parameters {
                string(name:'SPEC' , defaultValue:'cypress/e2e/RegisterTest.cy.js',description:enter the script you want to run)
                choice(name: 'BROWSER',choices: ['chrome', 'edge'], description: 'Select the browser for testing'

                    
                )

                options (ansiColor(xterm))


    stages {

        

        stage('Building') {
            steps {
                echo 'Building stage'
                // Add any build steps here if needed
                publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: false, reportDir: 'cypress\\reports', reportFiles: 'index.html', reportName: 'HTML Report', reportTitles: '', useWrapperFileDirectly: true])
            }
        }

        stage('Testing ') {
            steps {
                script {
                     bat 'npm i'
                     bat 'npx cypress run --browser ${BROWSER} --spec ${SPEC}'
                }
            }

            
           
            }
            
        }

        stage('Deploying') {
            steps {
                // Add steps to generate report here
                echo 'deploying step'
            }
        }
    }

    post {
        always {
            // Clean up any artifacts or temporary files if needed
            publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: false, reportDir: 'cypress\\reports', reportFiles: 'index.html', reportName: 'HTML Report', reportTitles: '', useWrapperFileDirectly: true])
        }
    }
}
